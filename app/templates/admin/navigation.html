{% extends 'admin/base_admin.html' %}
{% block title %}Navigation â€” ORIAL Admin{% endblock %}
{% block page_title %}Website Navigation{% endblock %}

{% block content %}
<div class="admin-top-actions">
    <div class="admin-card-title">Manage Menu Links</div>
    <a href="{{ url_for('admin.new_nav_item') }}" class="admin-btn primary">+ Add Nav Item</a>
</div>

<div class="admin-card">
    <table class="admin-table">
        <thead>
            <tr>
                <th>Order</th>
                <th>Label</th>
                <th>URL / Route</th>
                <th>Status</th>
                <th>External</th>
                <th style="text-align:right;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr id="navItem{{ item.id }}">
                <td>{{ item.display_order }}</td>
                <td style="font-weight:600;">{{ item.label }}</td>
                <td style="font-family:monospace;font-size:12px;color:#6b7280;">{{ item.url }}</td>
                <td>
                    {% if item.is_active %}
                    <span class="status-badge" style="background:#ecfdf5;color:#059669;">Active</span>
                    {% else %}
                    <span class="status-badge" style="background:#fef2f2;color:#dc2626;">Inactive</span>
                    {% endif %}
                </td>
                <td>{{ 'Yes' if item.is_external else 'No' }}</td>
                <td style="text-align:right;">
                    <a href="{{ url_for('admin.edit_nav_item', id=item.id) }}"
                        class="admin-btn secondary small">Edit</a>
                    <button onclick="deleteNavItem({{ item.id }})" class="admin-btn danger small">Delete</button>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" style="text-align:center;padding:40px;color:#9ca3af;">
                    No navigation items found. Add your first link to start.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    async function deleteNavItem(id) {
        if (!confirm('Are you sure you want to delete this navigation item?')) return;
        try {
            const response = await fetch(`/admin/navigation/delete/${id}`, {
                method: 'POST',
                headers: { 'X-CSRFToken': '{{ csrf_token() }}' }
            });
            const result = await response.json();
            if (result.success) {
                document.getElementById('navItem' + id).remove();
            }
        } catch (err) {
            alert('Error deleting item');
        }
    }
</script>
{% endblock %}